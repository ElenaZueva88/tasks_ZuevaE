Пользовательский сценарий

Пользователь: вводит логин и пароль
Система: проверяет пару логин и пароль (креды) с БД. Если креды есть, то авторизует пользователя и переводит на страницу Блога




ФЛК полей

Требование
Поля
Текст ошибки
Только латинские символов и цифр, без спецсимволов
Только логин
Неправильный логин. Может состоять только из латинских букв и цифр, без спецсимволов
Не менее 3 и не более 20 символов в одном поле
Только логин
Неправильный логин. Может быть не менее 3 и не более 20 символов
Поле не может быть пустым
Логин и пароль
Поле не может быть пустым


Проверка ФЛК срабатывает только после нажатия на кнопку Login.
В случае нарушения требований ФЛК запрос на бэкенд не отправляется, выводится текст ошибки под полем (см. дизайн)

Ошибки при взаимодействии с бэкендом:

Код ошибки
Текст ошибки
404
Проверьте соединение с интернетом и попробуйте еще раз
401
Проверьте логин и пароль
другие
Ошибка. Попробуйте еще раз позже



1.2. Создание аккаунтов Пользователей

Функционал доступен для роли "Студент-админ"

URL: https://test-stand.gb.ru/admin/student 
Дизайн: https://miro.com/app/board/uXjVPQrcDOA=/?share_link_id=597057378192 



Пользовательский сценарий

Система: отображает список созданных Пользователей
Студент: нажимает на иконку +
Система: предлагает набор полей для добавления пользователя
Студент: заполняет поля
Система: валидирует поля. При успехе создает нового Пользователя, а именно записывает данные в БД и создает креды (логин и пароль)
Студент: по клику на иконку ключик видит креды созданного Пользователя
Студент: по клику на иконку ручки может отредактировать данные Пользователя
Студент: по клику на иконку Урны может перевести студента в неактивные.




Требования, условия и ограничения

Требование
Отработка ошибки
Все поля, кроме New Avatar, являются обязательными
Под полем выводится ошибка с текстом Это значение не должно быть пустым
Поля First Name, Last Name, Login не могут быть короче 3 и длиннее 20 символов
Под полем выводится ошибка с текстом Значение не должно быть менее 3 и более 20 символов
В поле BirthDay по дефолту выставлена текущая дата. Возраст пользователя не может быть менее 7 лет и более 100 лет
Под полем выводится ошибка с текстом Укажите верную дату рождения
Поле Phone может быть от 10 до 12 символов. Только цифры и значок + в начале
Под полем выводится ошибка с текстом Укажите верный номер телефона
Поля Login и Phone могут быть только уникальными и не могут совпадать с другими Пользователями
Под полем выводится ошибка с текстом Предоставленное имя пользователя "goshgosh" не является уникальным, предоставленный телефон "89778019999" не является уникальным
При успехе пользователю присваивается порядковый номер
-



Создание тестового пользователя:

POST https://test-stand.gb.ru/gateway/dummies 



В теле запроса передаются данные авторизации:

{
"image": file,
"firstName": "String",
"lastName": "String",
"username": "String",
"phone": "String",
"sex": "String",
"birthDate": "String"
}


где:
	image – прикрепляется как файл, это аватарка пользователя,
	firstName – имя пользователя,
lastName – фамилия пользователя,
username – логин,
phone – номер телефона,
sex – пол (принимает значения male | female) ,
birthDate – дата рождения в формате ГГГГ-ММ-ДД (например: 2022-10-01)
В случае успешного ответа, в response мы получаем:

{
    "item": {
        "id": Integer,
        "username": "String",
        "password": "String",
        "status": "String"
    }
}


где:
	id – уникальный идентификатор пользователя,
username – логин,
password – пароль,
status – статус пользователя: активен/не активен (active/inactive)


В случае неуспешного ответа, в response мы получаем:

{
    "error": "validation unsuccessful",
    "code": 400,
    "message": [
        {
            "message": "String",
            "path": "username",
            "code": "String"
        }
    ]
}


где:
error – параметр, содержащий текст "Неуспешная попытка создания аккаунта",
code – код ошибки, 400,
message.message – параметр, содержащий текст ошибки,
message.code – параметр, содержащий код ошибки (1 – не заполнено одно из обязательных полей, 2 – не уникальный логин, 3 – не заполнено ни одно поле).

Авторизация в тестового пользователя:

POST https://test-stand.gb.ru/gateway/login

В теле запроса передаются данные авторизации (данные получаются из ответа в предыдущем запросе):

"username": "String",
"password": "String"


В случае успешного ответа, в response мы получаем:

{
	"id": Int,
	"username": "String",
	"token": "String",
	"roles": ["R_STUDENT", "R_USER", "P_DUMMY_ACTIVATE", "P_DUMMY_L", "P_DUMMY_C", "P_DUMMY_R", "P_DUMMY_U", "P_DUMMY_D", "P_USER_R", "P_USER_U", "P_USER_LOGOUT", "P_USER_LOGIN"]
}


где:
	id – идентификатор пользователя,
username – имя пользователя/логин,
token – токен пользователя (необходим для авторизации),
roles – массив с присвоенными ролями пользователю. 

Для последующей авторизации пользователей используется значение параметра token и название параметра X-Auth-Token, которые передаются в header запроса.


В случае с неуспешной авторизацией в тестовый аккаунт,

следующий ответ, если оба/один из кредов логин/пароль не верные:


{
    "error": "Invalid credentials.",
    "code": 401,
    "message": ""
}


следующий ответ, если оба/один из кредов не переданы:


{
    "error": "critical",
    "code": 400,
    "message": "The key \"password\" | \"username\" must be provided."
}

